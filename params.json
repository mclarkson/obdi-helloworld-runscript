{
  "name": "Obdi-helloworld-runscript",
  "tagline": "Demonstrates running a script on an Obdi worker",
  "body": "# obdi-helloworld-runscript\r\n\r\nThis Obdi plugin has a UI and runs a script on a worker.\r\n\r\n## Screenshot\r\n\r\n![](images/helloworld-endpoint.png?raw=true)\r\n\r\n## What is it?\r\nA starting point for writing an Obdi plugin that runs a script on a local\r\nor remote Obdi worker.\r\n\r\n* This plugin has a Web Interface.\r\n* This plugin adds a REST endpoint.\r\n\r\n    A REST endpoint, '/helloworld-runscript', is added that can be accessed by\r\n    other tools or from othe command line.\r\n\r\n* This plugin runs a script on workers.\r\n* This plugin does not use a private sqlite database.\r\n\r\nSimilar plugin: [obdi-saltkeymanager](https://github.com/mclarkson/obdi-saltkeymanager)\r\n\r\n## Manually accessing the REST endpoint\r\n\r\n```\r\n$ ipport=\"127.0.0.1:443\"\r\n\r\n$ guid=`curl -ks -d '{\"Login\":\"nomen.nescio\",\"Password\":\"password\"}' \\\r\n      https://$ipport/api/login | grep -o \"[a-z0-9][^\\\"]*\"`\r\n\r\n$ curl -k \"https://$ipport/api/nomen.nescio/$guid/helloworld-runscript/helloworld-runscript\"\r\n{ \r\n  \"Error\": \"Plugin returned error. 'var_a' must be set\"\r\n}\r\n\r\n$ curl -k \"https://$ipport/api/nomen.nescio/$guid/helloworld-runscript/helloworld-runscript?env_id=1&var_a=blobbyblobbyblobby\"\r\n{\"JobId\":346,\"Text\":\"\",\"PluginReturn\":0,\"PluginError\":\"\"}\r\n\r\n$ curl -k \"https://$ipport/api/nomen.nescio/$guid/outputlines?job_id=346\"\r\n[\r\n  {\r\n    \"Id\": 356,\r\n    \"JobId\": 346,\r\n    \"Serial\": 1,\r\n    \"Text\": \"\\nHello from test.centos.org\\n\\n\\n---------\\nArguments\\n---------\\nblobbyblobbyblobby\\n-----------\\nEnvironment\\n-----------\\nPWD=/tmp\\nSHLVL=1\\nSYSSCRIPTDIR=/var/lib/obdi-worker/scripts\\n_=/bin/env\\n\"\r\n  }\r\n]\r\n```\r\nType 1 output was used in the example Go code. Type 1 output can have multiple\r\nrecords with multiple lines in each record. Type 2 output will only ever have\r\none record that may contain many lines.\r\n\r\nThe job and its output can also be viewed using the System Jobs viewer.\r\n\r\nSee [obdi-dev-repository](https://github.com/mclarkson/obdi-dev-repository)\r\nfor more information about Dev plugins.\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}